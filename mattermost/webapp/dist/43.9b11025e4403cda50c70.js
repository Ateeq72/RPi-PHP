webpackJsonp([43],{1667:function(e,a,t){"use strict";var s=t(6),n=s&&s.__esModule?function(){return s["default"]}:function(){return s};t.d(n,"a",n);var r=t(3),i=r&&r.__esModule?function(){return r["default"]}:function(){return r};t.d(i,"a",i);var m=t(4),o=m&&m.__esModule?function(){return m["default"]}:function(){return m};t.d(o,"a",o);var l=t(7),d=l&&l.__esModule?function(){return l["default"]}:function(){return l};t.d(d,"a",d);var u=t(2),c=u&&u.__esModule?function(){return u["default"]}:function(){return u};t.d(c,"a",c);var g=t(1),f=g&&g.__esModule?function(){return g["default"]}:function(){return g};t.d(f,"a",f);var h=t(26),p=t(175),v=t(1634),_=t(12),E=_&&_.__esModule?function(){return _["default"]}:function(){return _};t.d(E,"a",E);var b=t(1630),M=t(567),j=M&&M.__esModule?function(){return M["default"]}:function(){return M};t.d(j,"a",j);var N=t(565),y=function(e){function a(e){i()(this,a);var t=d()(this,(a.__proto__||n()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.updateName=t.updateName.bind(t),t.updateImage=t.updateImage.bind(t),t.state={name:"",image:null,imageUrl:"",saving:!1,error:null},t}return c()(a,e),o()(a,[{key:"handleSubmit",value:function(e){var a=this;if(e.preventDefault(),!this.state.saving){this.setState({saving:!0,error:null});var t={creator_id:this.props.user.id,name:this.state.name.trim().toLowerCase()};return t.name.startsWith(":")&&t.name.endsWith(":")&&(t.name=t.name.substring(1,t.name.length-1)),t.name?/[^a-z0-9_-]/.test(t.name)?void this.setState({saving:!1,error:f.a.createElement(_.FormattedMessage,{id:"add_emoji.nameInvalid",defaultMessage:"An emoji's name can only contain lowercase letters, numbers, and the symbols '-' and '_'."})}):p.a.getSystemEmojis().has(t.name)?void this.setState({saving:!1,error:f.a.createElement(_.FormattedMessage,{id:"add_emoji.nameTaken",defaultMessage:"This name is already in use by a system emoji. Please choose another name."})}):this.state.image?void h.addEmoji(t,this.state.image,function(){a.context.router.push("/"+a.props.team.name+"/emoji")},function(e){a.setState({saving:!1,error:e.message})}):void this.setState({saving:!1,error:f.a.createElement(_.FormattedMessage,{id:"add_emoji.imageRequired",defaultMessage:"An image is required for the emoji"})}):void this.setState({saving:!1,error:f.a.createElement(_.FormattedMessage,{id:"add_emoji.nameRequired",defaultMessage:"A name is required for the emoji"})})}}},{key:"updateName",value:function(e){this.setState({name:e.target.value})}},{key:"updateImage",value:function(e){var a=this;if(0===e.target.files.length)return void this.setState({image:null,imageUrl:""});var t=e.target.files[0],s=new FileReader;s.onload=function(){a.setState({image:t,imageUrl:s.result})},s.readAsDataURL(t)}},{key:"render",value:function(){var e=null;this.state.image&&(e=f.a.createElement("span",{className:"add-emoji__filename"},this.state.image.name));var a=null;return this.state.imageUrl&&(a=f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"preview"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.preview",defaultMessage:"Preview"})),f.a.createElement("div",{className:"col-md-5 col-sm-8 add-emoji__preview"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.preview.sentence",defaultMessage:"This is a sentence with {image} in it.",values:{image:f.a.createElement("img",{className:"emoticon",src:this.state.imageUrl})}})))),f.a.createElement("div",{className:"backstage-content row"},f.a.createElement(v.a,null,f.a.createElement(M.Link,{to:"/"+this.props.team.name+"/emoji"},f.a.createElement(_.FormattedMessage,{id:"emoji_list.header",defaultMessage:"Custom Emoji"})),f.a.createElement(_.FormattedMessage,{id:"add_emoji.header",defaultMessage:"Add"})),f.a.createElement("div",{className:"backstage-form"},f.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.name",defaultMessage:"Name"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("input",{id:"name",type:"text",maxLength:"64",className:"form-control",value:this.state.name,onChange:this.updateName}),f.a.createElement("div",{className:"form__help"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.name.help",defaultMessage:"Choose a name for your emoji made of up to 64 characters consisting of lowercase letters, numbers, and the symbols '-' and '_'."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"image"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.image",defaultMessage:"Image"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("div",null,f.a.createElement("div",{className:"add-emoji__upload"},f.a.createElement("button",{className:"btn btn-primary"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.image.button",defaultMessage:"Select"})),f.a.createElement("input",{type:"file",accept:".jpg,.png,.gif",multiple:!1,onChange:this.updateImage})),e,f.a.createElement("div",{className:"form__help"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.image.help",defaultMessage:"Choose the image for your emoji. The image can be a gif, png, or jpeg file with a max size of 64 KB and dimensions up to 128 by 128 pixels."}))))),a,f.a.createElement("div",{className:"backstage-form__footer"},f.a.createElement(b.a,{type:"backstage",error:this.state.error}),f.a.createElement(M.Link,{className:"btn btn-sm",to:"/"+this.props.team.name+"/emoji"},f.a.createElement(_.FormattedMessage,{id:"add_emoji.cancel",defaultMessage:"Cancel"})),f.a.createElement(N.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,onClick:this.handleSubmit},f.a.createElement(_.FormattedMessage,{id:"add_emoji.save",defaultMessage:"Save"}))))))}}]),a}(f.a.Component);y.propTypes={team:f.a.PropTypes.object.isRequired,user:f.a.PropTypes.object.isRequired},y.contextTypes={router:f.a.PropTypes.object.isRequired},a["default"]=y}});