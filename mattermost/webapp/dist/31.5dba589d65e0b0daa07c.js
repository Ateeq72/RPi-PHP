webpackJsonp([31],{1682:function(e,t,a){"use strict";var r=a(47),s=r&&r.__esModule?function(){return r["default"]}:function(){return r};a.d(s,"a",s);var o=a(6),n=o&&o.__esModule?function(){return o["default"]}:function(){return o};a.d(n,"a",n);var l=a(3),i=l&&l.__esModule?function(){return l["default"]}:function(){return l};a.d(i,"a",i);var d=a(7),c=d&&d.__esModule?function(){return d["default"]}:function(){return d};a.d(c,"a",c);var m=a(4),g=m&&m.__esModule?function(){return m["default"]}:function(){return m};a.d(g,"a",g);var u=a(2),h=u&&u.__esModule?function(){return u["default"]}:function(){return u};a.d(h,"a",h);var p=a(1),f=p&&p.__esModule?function(){return p["default"]}:function(){return p};a.d(f,"a",f);var v=a(26),_=a(1634),b=a(1645),E=a(12),k=E&&E.__esModule?function(){return E["default"]}:function(){return E};a.d(k,"a",k);var y=a(1630),w=a(53),M=a(565),N=function(e){function t(e){i()(this,t);var a=c()(this,(t.__proto__||n()(t)).call(this,e));return a.handleSubmit=a.handleSubmit.bind(a),a.updateDisplayName=a.updateDisplayName.bind(a),a.updateDescription=a.updateDescription.bind(a),a.updateContentType=a.updateContentType.bind(a),a.updateChannelId=a.updateChannelId.bind(a),a.updateTriggerWords=a.updateTriggerWords.bind(a),a.updateTriggerWhen=a.updateTriggerWhen.bind(a),a.updateCallbackUrls=a.updateCallbackUrls.bind(a),a.state={displayName:"",description:"",contentType:"application/x-www-form-urlencoded",channelId:"",triggerWords:"",triggerWhen:0,callbackUrls:"",saving:!1,serverError:"",clientError:null},a}return h()(t,e),g()(t,null,[{key:"propTypes",get:function(){return{team:f.a.propTypes.object.isRequired}}}]),g()(t,[{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),!this.state.saving){this.setState({saving:!0,serverError:"",clientError:""});var a=[];if(this.state.triggerWords){var r=!0,o=!1,n=void 0;try{for(var l,i=s()(this.state.triggerWords.split("\n"));!(r=(l=i.next()).done);r=!0){var d=l.value;d=d.trim(),d.length>0&&a.push(d)}}catch(c){o=!0,n=c}finally{try{!r&&i["return"]&&i["return"]()}finally{if(o)throw n}}}if(!this.state.channelId&&0===a.length)return void this.setState({saving:!1,clientError:f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.triggerWordsOrChannelRequired",defaultMessage:"A valid channel or a list of trigger words is required"})});var m=[],g=!0,u=!1,h=void 0;try{for(var p,_=s()(this.state.callbackUrls.split("\n"));!(g=(p=_.next()).done);g=!0){var b=p.value;b=b.trim(),b.length>0&&m.push(b)}}catch(c){u=!0,h=c}finally{try{!g&&_["return"]&&_["return"]()}finally{if(u)throw h}}if(0===m.length)return void this.setState({saving:!1,clientError:f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.callbackUrlsRequired",defaultMessage:"One or more callback URLs are required"})});var k={channel_id:this.state.channelId,trigger_words:a,trigger_when:parseInt(this.state.triggerWhen,10),callback_urls:m,display_name:this.state.displayName,content_type:this.state.contentType,description:this.state.description};v.addOutgoingHook(k,function(e){w.a.push("/"+t.props.team.name+"/integrations/confirm?type=outgoing_webhooks&id="+e.id)},function(e){t.setState({saving:!1,serverError:e.message})})}}},{key:"updateDisplayName",value:function(e){this.setState({displayName:e.target.value})}},{key:"updateDescription",value:function(e){this.setState({description:e.target.value})}},{key:"updateContentType",value:function(e){this.setState({contentType:e.target.value})}},{key:"updateChannelId",value:function(e){this.setState({channelId:e.target.value})}},{key:"updateTriggerWords",value:function(e){this.setState({triggerWords:e.target.value})}},{key:"updateTriggerWhen",value:function(e){this.setState({triggerWhen:e.target.value})}},{key:"updateCallbackUrls",value:function(e){this.setState({callbackUrls:e.target.value})}},{key:"render",value:function(){var e="application/x-www-form-urlencoded",t="application/json";return f.a.createElement("div",{className:"backstage-content"},f.a.createElement(_.a,null,f.a.createElement(w.b,{to:"/"+this.props.team.name+"/integrations/outgoing_webhooks"},f.a.createElement(E.FormattedMessage,{id:"installed_outgoing_webhooks.header",defaultMessage:"Outgoing Webhooks"})),f.a.createElement(E.FormattedMessage,{id:"integrations.add",defaultMessage:"Add"})),f.a.createElement("div",{className:"backstage-form"},f.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.displayName",defaultMessage:"Display Name"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.displayName.help",defaultMessage:"Display name for your incoming webhook made of up to 64 characters."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.description",defaultMessage:"Description"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("input",{id:"description",type:"text",maxLength:"128",className:"form-control",value:this.state.description,onChange:this.updateDescription}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.description.help",defaultMessage:"Description for your incoming webhook."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"contentType"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.content_Type",defaultMessage:"Content Type"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("select",{className:"form-control",value:this.state.contentType,onChange:this.updateContentType},f.a.createElement("option",{value:e},e),f.a.createElement("option",{value:t},t)),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.contentType.help1",defaultMessage:"Choose the content type by which the response will be sent."})),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.contentType.help2",defaultMessage:"If application/x-www-form-urlencoded is chosen, the server assumes you will be encoding the parameters in a URL format."})),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.contentType.help3",defaultMessage:"If application/json is chosen, the server assumes you will posting JSON data."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"channelId"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.channel",defaultMessage:"Channel"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement(b.a,{id:"channelId",value:this.state.channelId,onChange:this.updateChannelId,selectOpen:!0}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.channel.help",defaultMessage:"Public channel to receive webhook payloads. Optional if at least one Trigger Word is specified."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"triggerWords"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.triggerWords",defaultMessage:"Trigger Words (One Per Line)"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("textarea",{id:"triggerWords",rows:"3",maxLength:"1000",className:"form-control",value:this.state.triggerWords,onChange:this.updateTriggerWords}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.triggerWords.help",defaultMessage:"Messages that start with one of the specified words will trigger the outgoing webhook. Optional if Channel is selected."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"triggerWords"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.triggerWordsTriggerWhen",defaultMessage:"Trigger When"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("select",{className:"form-control",value:this.state.triggerWhen,onChange:this.updateTriggerWhen},f.a.createElement("option",{value:"0"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.triggerWordsTriggerWhenFullWord",defaultMessage:"First word matches a trigger word exactly"})),f.a.createElement("option",{value:"1"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.triggerWordsTriggerWhenStartsWith",defaultMessage:"First word starts with a trigger word"}))),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.triggerWordsTriggerWhen.help",defaultMessage:"Choose when to trigger the outgoing webhook; if the first word of a message matches a Trigger Word exactly, or if it starts with a Trigger Word."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"callbackUrls"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.callbackUrls",defaultMessage:"Callback URLs (One Per Line)"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("textarea",{id:"callbackUrls",rows:"3",maxLength:"1000",className:"form-control",value:this.state.callbackUrls,onChange:this.updateCallbackUrls}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.callbackUrls.help",defaultMessage:"The URL that messages will be sent to."})))),f.a.createElement("div",{className:"backstage-form__footer"},f.a.createElement(y.a,{type:"backstage",errors:[this.state.serverError,this.state.clientError]}),f.a.createElement(w.b,{className:"btn btn-sm",to:"/"+this.props.team.name+"/integrations/outgoing_webhooks"},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.cancel",defaultMessage:"Cancel"})),f.a.createElement(M.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,onClick:this.handleSubmit},f.a.createElement(E.FormattedMessage,{id:"add_outgoing_webhook.save",defaultMessage:"Save"}))))))}}]),t}(f.a.Component);t["default"]=N}});