webpackJsonp([32],{1681:function(e,a,t){"use strict";var s=t(47),r=s&&s.__esModule?function(){return s["default"]}:function(){return s};t.d(r,"a",r);var l=t(6),n=l&&l.__esModule?function(){return l["default"]}:function(){return l};t.d(n,"a",n);var i=t(3),o=i&&i.__esModule?function(){return i["default"]}:function(){return i};t.d(o,"a",o);var c=t(7),d=c&&c.__esModule?function(){return c["default"]}:function(){return c};t.d(d,"a",d);var u=t(4),m=u&&u.__esModule?function(){return u["default"]}:function(){return u};t.d(m,"a",m);var p=t(2),h=p&&p.__esModule?function(){return p["default"]}:function(){return p};t.d(h,"a",h);var g=t(1),f=g&&g.__esModule?function(){return g["default"]}:function(){return g};t.d(f,"a",f);var _=t(1641),v=t(1634),E=t(12),b=E&&E.__esModule?function(){return E["default"]}:function(){return E};t.d(b,"a",b);var M=t(1630),N=t(53),y=t(565),k=function(e){function a(e){o()(this,a);var t=d()(this,(a.__proto__||n()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.updateName=t.updateName.bind(t),t.updateTrusted=t.updateTrusted.bind(t),t.updateDescription=t.updateDescription.bind(t),t.updateHomepage=t.updateHomepage.bind(t),t.updateIconUrl=t.updateIconUrl.bind(t),t.updateCallbackUrls=t.updateCallbackUrls.bind(t),t.imageLoaded=t.imageLoaded.bind(t),t.image=new Image,t.image.onload=t.imageLoaded,t.state={name:"",description:"",homepage:"",icon_url:"",callbackUrls:"",is_trusted:!1,has_icon:!1,saving:!1,serverError:"",clientError:null},t}return h()(a,e),m()(a,null,[{key:"propTypes",get:function(){return{team:f.a.propTypes.object.isRequired}}}]),m()(a,[{key:"imageLoaded",value:function(){this.setState({has_icon:!0,icon_url:this.refs.icon_url.value})}},{key:"handleSubmit",value:function(e){var a=this;if(e.preventDefault(),!this.state.saving){if(this.setState({saving:!0,serverError:"",clientError:""}),!this.state.name)return void this.setState({saving:!1,clientError:f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.nameRequired",defaultMessage:"Name for the OAuth 2.0 application is required."})});if(!this.state.description)return void this.setState({saving:!1,clientError:f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.descriptionRequired",defaultMessage:"Description for the OAuth 2.0 application is required."})});if(!this.state.homepage)return void this.setState({saving:!1,clientError:f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.homepageRequired",defaultMessage:"Homepage for the OAuth 2.0 application is required."})});var t=[],s=!0,l=!1,n=void 0;try{for(var i,o=r()(this.state.callbackUrls.split("\n"));!(s=(i=o.next()).done);s=!0){var c=i.value;c=c.trim(),c.length>0&&t.push(c)}}catch(d){l=!0,n=d}finally{try{!s&&o["return"]&&o["return"]()}finally{if(l)throw n}}if(0===t.length)return void this.setState({saving:!1,clientError:f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.callbackUrlsRequired",defaultMessage:"One or more callback URLs are required."})});var u={name:this.state.name,callback_urls:t,homepage:this.state.homepage,description:this.state.description,is_trusted:this.state.is_trusted,icon_url:this.state.icon_url};_.registerOAuthApp(u,function(e){N.a.push("/"+a.props.team.name+"/integrations/confirm?type=oauth2-apps&id="+e.id)},function(e){a.setState({saving:!1,serverError:e.message})})}}},{key:"updateName",value:function(e){this.setState({name:e.target.value})}},{key:"updateTrusted",value:function(e){this.setState({is_trusted:"true"===e.target.value})}},{key:"updateDescription",value:function(e){this.setState({description:e.target.value})}},{key:"updateHomepage",value:function(e){this.setState({homepage:e.target.value})}},{key:"updateIconUrl",value:function(e){this.setState({has_icon:!1,icon_url:""}),this.image.src=e.target.value}},{key:"updateCallbackUrls",value:function(e){this.setState({callbackUrls:e.target.value})}},{key:"render",value:function(){var e=void 0;return this.state.has_icon&&(e=f.a.createElement("div",{className:"integration__icon"},f.a.createElement("img",{src:this.state.icon_url}))),f.a.createElement("div",{className:"backstage-content"},f.a.createElement(v.a,null,f.a.createElement(N.b,{to:"/"+this.props.team.name+"/integrations/oauth2-apps"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.header",defaultMessage:"Installed OAuth2 Apps"})),f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.header",defaultMessage:"Add"})),f.a.createElement("div",{className:"backstage-form"},e,f.a.createElement("form",{className:"form-horizontal"},f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"is_trusted"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.trusted",defaultMessage:"Is Trusted"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("label",{className:"radio-inline"},f.a.createElement("input",{type:"radio",value:"true",name:"is_trusted",checked:this.state.is_trusted,onChange:this.updateTrusted}),f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.trusted.yes",defaultMessage:"Yes"})),f.a.createElement("label",{className:"radio-inline"},f.a.createElement("input",{type:"radio",value:"false",name:"is_trusted",checked:!this.state.is_trusted,onChange:this.updateTrusted}),f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.trusted.no",defaultMessage:"No"})),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.trusted.help",defaultMessage:"When true, the OAuth 2.0 application is considered trusted by the Mattermost server and doesn't require the user to accept authorization. When false, an additional window will appear, asking the user to accept or deny the authorization."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.name",defaultMessage:"Display Name"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("input",{id:"name",type:"text",maxLength:"64",className:"form-control",value:this.state.name,onChange:this.updateName}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.name.help",defaultMessage:"Display name for your OAuth 2.0 application made of up to 64 characters."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.description",defaultMessage:"Description"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("input",{id:"description",type:"text",maxLength:"512",className:"form-control",value:this.state.description,onChange:this.updateDescription}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.description.help",defaultMessage:"Description for your OAuth 2.0 application."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"homepage"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.homepage",defaultMessage:"Homepage"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("input",{id:"homepage",type:"url",maxLength:"256",className:"form-control",value:this.state.homepage,onChange:this.updateHomepage}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.homepage.help",defaultMessage:"The URL for the homepage of the OAuth 2.0 application. Make sure you use HTTP or HTTPS in your URL depending on your server configuration."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"icon_url"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.iconUrl",defaultMessage:"Icon URL"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("input",{id:"icon_url",ref:"icon_url",type:"url",maxLength:"512",className:"form-control",onChange:this.updateIconUrl}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.icon.help",defaultMessage:"The URL for the homepage of the OAuth 2.0 application. Make sure you use HTTP or HTTPS in your URL depending on your server configuration."})))),f.a.createElement("div",{className:"form-group"},f.a.createElement("label",{className:"control-label col-sm-4",htmlFor:"callbackUrls"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.callbackUrls",defaultMessage:"Callback URLs (One Per Line)"})),f.a.createElement("div",{className:"col-md-5 col-sm-8"},f.a.createElement("textarea",{id:"callbackUrls",rows:"3",maxLength:"1024",className:"form-control",value:this.state.callbackUrls,onChange:this.updateCallbackUrls}),f.a.createElement("div",{className:"form__help"},f.a.createElement(E.FormattedMessage,{id:"add_oauth_app.callbackUrls.help",defaultMessage:"The redirect URIs to which the service will redirect users after accepting or denying authorization of your application, and which will handle authorization codes or access tokens. Must be a valid URL and start with http:// or https://."})))),f.a.createElement("div",{className:"backstage-form__footer"},f.a.createElement(M.a,{type:"backstage",errors:[this.state.serverError,this.state.clientError]}),f.a.createElement(N.b,{className:"btn btn-sm",to:"/"+this.props.team.name+"/integrations/oauth2-apps"},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.cancel",defaultMessage:"Cancel"})),f.a.createElement(y.a,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,onClick:this.handleSubmit},f.a.createElement(E.FormattedMessage,{id:"installed_oauth_apps.save",defaultMessage:"Save"}))))))}}]),a}(f.a.Component);a["default"]=k}});